# Avon Task Runner - Architecture & Flow Diagrams

## High-Level Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Avon Task Runner System                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€ CLI Layer â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                   â”‚
â”‚  $ avon do <task> [file]                                         â”‚
â”‚       â†“                                                           â”‚
â”‚  run_cli() match "do"                                            â”‚
â”‚       â†“                                                           â”‚
â”‚  parse_args(rest, require_file=true)                            â”‚
â”‚       â†“                                                           â”‚
â”‚  execute_do(CliOptions)                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Evaluation Layer                                                   â”‚
â”‚                                                                    â”‚
â”‚  get_source() â†’ Load Avonfile.av or specified file              â”‚
â”‚       â†“                                                            â”‚
â”‚  tokenize() â†’ Lexical analysis                                   â”‚
â”‚       â†“                                                            â”‚
â”‚  parse() â†’ Build AST                                              â”‚
â”‚       â†“                                                            â”‚
â”‚  eval() â†’ Evaluate to Value                                      â”‚
â”‚       â†“                                                            â”‚
â”‚  extract_tasks() â†’ Parse Value::Dict to HashMap<TaskDef>        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Task Runner Layer                                                 â”‚
â”‚                                                                    â”‚
â”‚  TaskRunner::new(tasks)                                           â”‚
â”‚       â†“                                                            â”‚
â”‚  validate_tasks()                                                â”‚
â”‚    â”œâ”€ Check all deps exist â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚    â”‚                                                â”‚             â”‚
â”‚    â””â”€ Detect cycles â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤             â”‚
â”‚                       (return error if found)      â”‚             â”‚
â”‚       â†“                                             â”‚             â”‚
â”‚  build_execution_plan(task_name)                   â”‚             â”‚
â”‚       â”œâ”€ topological_sort(task_name)  â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚       â”‚    â””â”€ DFS to order tasks                                 â”‚
â”‚       â”‚                                                           â”‚
â”‚       â””â”€ ExecutionPlan {tasks, order}                            â”‚
â”‚                                                                   â”‚
â”‚  run(task_name)                                                  â”‚
â”‚       â”œâ”€ Get ExecutionPlan                                       â”‚
â”‚       â”‚                                                           â”‚
â”‚       â””â”€ For each task in order:                                 â”‚
â”‚            â”œâ”€ Shell::execute(cmd)                                â”‚
â”‚            â”œâ”€ Pass env vars                                      â”‚
â”‚            â”œâ”€ Check exit code                                    â”‚
â”‚            â””â”€ Return error if failed                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Output                                                            â”‚
â”‚                                                                  â”‚
â”‚ "Running: task_name"                                            â”‚
â”‚ [command output]                                                â”‚
â”‚ "Task 'task_name' completed successfully"                       â”‚
â”‚                                                                  â”‚
â”‚ OR                                                               â”‚
â”‚                                                                  â”‚
â”‚ "Error: [helpful error message]"                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Execution Flow Example

### Scenario: `avon do release` with dependencies

```
Avonfile.av:
{
  check: "cargo check",
  build: {cmd: "cargo build", deps: ["check"]},
  test: {cmd: "cargo test", deps: ["build"]},
  release: {cmd: "cargo build --release", deps: ["test"]}
}

Command: $ avon do release

Execution Flow:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. Parse input                                              â”‚
â”‚    task_name = "release"                                    â”‚
â”‚    file = "Avonfile.av"                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2. Load and evaluate file                                   â”‚
â”‚    Avonfile.av â†’ eval â†’ Value::Dict                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3. Parse tasks                                              â”‚
â”‚    {check, build, test, release} â†’ HashMap<TaskDef>        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 4. Validate                                                 â”‚
â”‚    âœ“ All deps exist                                         â”‚
â”‚    âœ“ No cycles detected                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 5. Build execution plan                                     â”‚
â”‚    topological_sort("release")                              â”‚
â”‚                                                             â”‚
â”‚    release                                                  â”‚
â”‚       â†“ (depends on)                                        â”‚
â”‚    test                                                     â”‚
â”‚       â†“ (depends on)                                        â”‚
â”‚    build                                                    â”‚
â”‚       â†“ (depends on)                                        â”‚
â”‚    check                                                    â”‚
â”‚                                                             â”‚
â”‚    âŸ¹ ExecutionPlan:                                        â”‚
â”‚      order: ["check", "build", "test", "release"]         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 6. Execute in order                                         â”‚
â”‚                                                             â”‚
â”‚    Running: check                                           â”‚
â”‚    $ cargo check                                            â”‚
â”‚    âœ“ Exit code 0                                            â”‚
â”‚                                                             â”‚
â”‚    Running: build                                           â”‚
â”‚    $ cargo build                                            â”‚
â”‚    âœ“ Exit code 0                                            â”‚
â”‚                                                             â”‚
â”‚    Running: test                                            â”‚
â”‚    $ cargo test                                             â”‚
â”‚    âœ“ Exit code 0                                            â”‚
â”‚                                                             â”‚
â”‚    Running: release                                         â”‚
â”‚    $ cargo build --release                                  â”‚
â”‚    âœ“ Exit code 0                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 7. Success message                                          â”‚
â”‚    Task 'release' completed successfully                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Dependency Resolution Algorithm

### Topological Sort (DFS-based)

```
Input: Task name "release"
Graph:
  release â†’ test â†’ build â†’ check
  
Algorithm:
  1. Start at "release"
  2. DFS to find all dependencies
  3. Add to result in reverse order of completion
  
  DFS("release"):
    visited = {release}
    DFS("test"):
      visited = {release, test}
      DFS("build"):
        visited = {release, test, build}
        DFS("check"):
          visited = {release, test, build, check}
          check has no deps â†’ add "check" to result
        build has no more deps â†’ add "build" to result
      test has no more deps â†’ add "test" to result
    release has no more deps â†’ add "release" to result
  
  Result: [check, build, test, release] âœ“
```

## Cycle Detection Algorithm

### DFS with Recursion Stack

```
Input: All tasks {a, b, c}
Task a â†’ Task b â†’ Task a (cycle!)

Algorithm:
  visited = {}
  rec_stack = {}
  
  For each task:
    has_cycle(task):
      visited.add(task)
      rec_stack.add(task)
      
      For each dependency:
        if not in visited:
          if has_cycle(dep) â†’ ERROR (cycle found!)
        else if in rec_stack:
          â†’ ERROR (back edge = cycle!)
      
      rec_stack.remove(task)
  
  has_cycle(a):
    visited = {a}, rec_stack = {a}
    has_cycle(b):
      visited = {a, b}, rec_stack = {a, b}
      has_cycle(a):  â† a in rec_stack!
        ERROR: Cyclic dependency!
```

## Error Handling Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Extract Tasks                            â”‚
â”‚ â†“                                        â”‚
â”‚ Validate                                 â”‚
â”‚   â”œâ”€ Check undefined deps                â”‚
â”‚   â”‚   â†“ (error â†’ TaskError::              â”‚
â”‚   â”‚       UndefinedDependency)            â”‚
â”‚   â”‚                                       â”‚
â”‚   â””â”€ Check cycles                        â”‚
â”‚       â†“ (error â†’ TaskError::              â”‚
â”‚           CyclicDependency)               â”‚
â”‚ â†“                                        â”‚
â”‚ Execute                                  â”‚
â”‚   â””â”€ Run shell command                   â”‚
â”‚       â†“ (error â†’ TaskError::              â”‚
â”‚           ExecutionFailed)                â”‚
â”‚ â†“                                        â”‚
â”‚ Success                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Data Structure Relationships

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ CliOptions                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ file: String           â† task name for "do"â”‚
â”‚ pos_args: Vec<String>  â† additional args   â”‚
â”‚ debug: bool                                â”‚
â”‚ ...other options...                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â†“
        execute_do(options)
                  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ HashMap<String, TaskDef>                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ "check" â†’ TaskDef {                        â”‚
â”‚             name: "check",                 â”‚
â”‚             cmd: "cargo check",            â”‚
â”‚             deps: [],                      â”‚
â”‚             desc: None,                    â”‚
â”‚             env: {}                        â”‚
â”‚           }                                â”‚
â”‚ "build" â†’ TaskDef { ... }                  â”‚
â”‚ ...                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â†“
         TaskRunner::new(tasks)
                  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ TaskRunner                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ tasks: HashMap<String, TaskDef>            â”‚
â”‚ executed: HashSet<String>                  â”‚
â”‚                                            â”‚
â”‚ Methods:                                   â”‚
â”‚ - validate_tasks()                         â”‚
â”‚ - has_cycle()                              â”‚
â”‚ - topological_sort()                       â”‚
â”‚ - build_execution_plan()                   â”‚
â”‚ - run(task_name)                           â”‚
â”‚ - run_dry()                                â”‚
â”‚ - list_tasks()                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â†“
        TaskRunner::run("release")
                  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ExecutionPlan                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ tasks: Vec<TaskDef>    â† all tasks         â”‚
â”‚ order: Vec<String>     â† execution order   â”‚
â”‚                          ["check", "build",â”‚
â”‚                           "test", "release"]
â”‚                                            â”‚
â”‚ Methods:                                   â”‚
â”‚ - format() â† for --dry-run (Phase 2)       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Feature Timeline

### Phase 1 (âœ… Complete)
```
Weeks 1-2: Core Implementation
â”œâ”€ TaskDef & parsing âœ“
â”œâ”€ TaskRunner & algorithms âœ“
â”œâ”€ Cycle detection âœ“
â”œâ”€ Error handling âœ“
â””â”€ CLI integration âœ“

Deliverables:
â”œâ”€ 587-line task_runner.rs âœ“
â”œâ”€ execute_do() command âœ“
â”œâ”€ 11 unit tests âœ“
â”œâ”€ Documentation âœ“
â””â”€ 0 compilation errors âœ“
```

### Phase 2 (ğŸ“‹ Planned)
```
Weeks 3-4: Advanced Features
â”œâ”€ --dry-run flag
â”œâ”€ --list flag
â”œâ”€ --info flag
â”œâ”€ Avonfile.av auto-discovery
â””â”€ Integration tests
```

### Phase 3 (ğŸ’¡ Future)
```
Week 5: Polish & Optimization
â”œâ”€ Multiple task execution
â”œâ”€ Conditional execution
â”œâ”€ Output filtering
â””â”€ Performance tuning
```

---

This architecture is designed to be:
- **Extensible** - Easy to add Phase 2 features
- **Maintainable** - Clean separation of concerns
- **Testable** - Each component independently testable
- **Performant** - Linear time dependency resolution
- **User-friendly** - Clear error messages
